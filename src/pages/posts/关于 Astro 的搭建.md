---
layout: ../../layouts/post.astro
title: "å…³äº Astro çš„æ­å»º"
pubDate: 2024-12-08
description: "ä¼—æ‰€å‘¨çŸ¥ï¼Œæ­äº†åšå®¢åçš„ç¬¬ä¸€ç¯‡åšå®¢ä¸€å®šæ˜¯å†™æ€ä¹ˆæ­åšå®¢ï¼"
author: "S"
excerpt: ä¼—æ‰€å‘¨çŸ¥ï¼Œæ­äº†åšå®¢åçš„ç¬¬ä¸€ç¯‡åšå®¢ä¸€å®šæ˜¯å†™æ€ä¹ˆæ­åšå®¢ï¼
image:
  src:
  alt:
tags: ["Astro", "æŠ˜è…¾"]
---

è¿™å·²ç»ä¸æ˜¯æˆ‘æ­çš„ç¬¬ä¸€ä¸ªåšå®¢äº†ï¼Œæœ‰ [Rin], [memos] ç­‰ç­‰... ç”¨ç€éƒ½æŒºä¸é”™çš„ï¼Œä½†æ˜¯æ€»æ˜¯å‡ºäºæŸäº›åŸå› æ²¡æœ‰ç»§ç»­ä¸‹å» ~~(å¤ªæ‡’äº†ğŸ¤£~~

ä½†æ˜¯æ€»å¾—ç»§ç»­æŠ˜è…¾å§ï¼

## å…³äº Astro

å‰ç«¯æ¡†æ¶ Astro æ˜¯ä¸€ä¸ªä½¿ç”¨ JavaScript æ„å»º Web åº”ç”¨ç¨‹åºçš„å·¥å…·ã€‚æ—¨åœ¨ç®€å•çš„åˆ›å»ºå¿«é€Ÿã€å¯é ä¸”æ˜“äºç»´æŠ¤çš„ Web åº”ç”¨ç¨‹åºã€‚æœ€é€‚åˆæ„å»ºåƒåšå®¢ã€è¥é”€ç½‘ç«™ã€ç”µå­å•†åŠ¡ç½‘ç«™è¿™æ ·çš„ä»¥å†…å®¹é©±åŠ¨çš„ç½‘ç«™çš„ Web æ¡†æ¶ã€‚

Astro æ”¯æŒå¤šç§å‰ç«¯æ¡†æ¶ï¼ŒåŒ…æ‹¬ Reactã€Vue å’Œ Svelteï¼Œå¯ä»¥å¸®åŠ©å¼€å‘äººå‘˜æ›´è½»æ¾åœ°ä½¿ç”¨è¿™äº›æ¡†æ¶æ¥æ„å»º Web åº”ç”¨ç¨‹åºã€‚å¹¶ä¸”æ”¯æŒå¤šä¸ªå¹³å° SSR å’Œé™æ€éƒ¨ç½²ã€‚

æˆ‘å°±éƒ¨ç½²åœ¨ [Cloudflare] ä¸Šé¢å§ï¼Œæˆ‘å·²ç»ç¦»ä¸å¼€**èµ›åšè©è¨**äº†ğŸ˜‹

## éƒ¨ç½² Astro è‡³ Cloudflare Pages

Cloudflare Pages æ˜¯ä¸€ä¸ªä¾›å‰ç«¯å¼€å‘äººå‘˜åä½œå’Œéƒ¨ç½²é™æ€ (JAMstack) æˆ– SSR ç½‘ç«™çš„å¹³å°ã€‚

### å‰ææ¡ä»¶

å¼€å§‹ä¹‹å‰ï¼Œä½ éœ€è¦ï¼š

- ä¸€ä¸ª [Cloudflare] è´¦å·ã€‚å¦‚æœè¿˜æ²¡æœ‰ï¼Œå¯ä»¥ç°åœ¨å…è´¹å» [Cloudflare] å®˜ç½‘æ³¨å†Œä¸€ä¸ªã€‚
- ä½ çš„æºä»£ç å­˜å‚¨åœ¨ [GitHub] æˆ–è€… GitLab ä»“åº“é‡Œã€‚

### ä½¿ç”¨ Git éƒ¨ç½²

1. å°†ä»£ç æäº¤åˆ° Git ä»“åº“ä¸­ã€‚
2. åœ¨ Cloudflare Pages è®¾ç½®ä¸€ä¸ªæ–°é¡¹ç›®ã€‚
3. ç™»å½• Cloudflare æ§åˆ¶å°å¹¶åœ¨é€‰æ‹© Workers å’Œ Pages > æ¦‚è¿°ã€‚
4. åœ¨æ¦‚è¿°é¡µé¢ä¸­ï¼Œé€‰æ‹© Pages æ ‡ç­¾é¡µï¼Œæ¥ç€é€‰æ‹© è¿æ¥å¯¼ Git é€‰é¡¹ã€‚
5. é€‰æ‹©ä½ çš„è´¦å·å’Œæƒ³éƒ¨ç½²çš„ Git é¡¹ç›®å¹¶ç‚¹å‡»å¼€å§‹è®¾ç½®ã€‚
6. ä½¿ç”¨ä»¥ä¸‹çš„æ„å»ºè®¾ç½®ï¼š
   - æ¡†æ¶é¢„è®¾: `Astro`
   - æ„å»ºå‘½ä»¤: `npm run build`
   - æ„å»ºè¾“å‡ºç›®å½•: `dist`
7. ç‚¹å‡»ä¿å­˜å¹¶éƒ¨ç½²æŒ‰é’®ã€‚

ç­‰å¾… Cloudflare æ„å»ºå’Œéƒ¨ç½²å®Œæˆã€‚

#### æ„å»ºå¤±è´¥ é—®é¢˜è§£å†³

```sh title="Cloudflare é”™è¯¯ä¿¡æ¯" showLineNumbers {5-7}
14:27:07 [build] 12 page(s) built in 3.02s
14:27:07 [build] Complete!
Finished
Note: No functions dir at /functions found. Skipping.
Validating asset output directory
Error: Output directory "dist" not found.
Failed: build output directory not found.
```

æ‰¾äº†åŠå¤©ï¼Œå‘ç°ä»£ç æ‰“åŒ…é…ç½®é‡Œé¢æœ‰ä¸ª vercel çš„é…ç½®ã€‚

```ts title="astro.config.mjs" showLineNumbers {2,5-10}
import { defineConfig } from "astro/config";
import vercelStatic from "@astrojs/vercel/static";

export default defineConfig({
  output: "static",
  adapter: vercelStatic({
    webAnalytics: {
      enabled: true,
    },
  }),
});
```

åº”è¯¥æ˜¯ä½œè€…ç”¨çš„ vercel éƒ¨ç½²ï¼Œæˆ‘è¿™é‡Œä¸éœ€è¦è¿™äº›é…ç½®ï¼Œæ‰€ä»¥åˆ é™¤é‡æ–°éƒ¨ç½²å°±å¥½äº†ã€‚

éƒ¨ç½²å®Œæˆ:
![éƒ¨ç½²å®Œæˆ](/public/images/Cloudflare.png "éƒ¨ç½²å®Œæˆ")

#### è‡ªå®šä¹‰åŸŸå

å¦‚æœä½ æœ‰åŸŸåæ‰˜ç®¡åœ¨ Cloudflare ä¸Šé¢ï¼Œé‚£è‡ªå®šä¹‰åŸŸåå°±æ¯”è¾ƒç®€å•äº†ã€‚

1. åœ¨ Workers å’Œ Pages ä¸­æ‰¾åˆ°åˆšåˆšéƒ¨ç½²å®Œæˆçš„åº”ç”¨ç¨‹åºã€‚
2. åœ¨è¯¦æƒ…é¡µé¢ä¸­ï¼Œé€‰æ‹© è‡ªå®šä¹‰åŸŸ æ ‡ç­¾é¡µï¼Œæ¥ç€ç‚¹å‡» è®¾ç½®è‡ªå®šä¹‰åŸŸ é€‰é¡¹ã€‚
3. å¡«å…¥å·²ç»åœ¨ Cloudflare ä¸­æ‰˜ç®¡çš„åŸŸåï¼Œç‚¹å‡»ç»§ç»­ã€‚
  ![è‡ªå®šä¹‰åŸŸ1](/public/images/zdyy1.png "è‡ªå®šä¹‰åŸŸ1")
4. ç¡®è®¤ DNS è®°å½•å€¼ï¼Œç‚¹å‡» æ¿€æ´»åŸŸ ã€‚Cloudflare ä¼šå¸®æˆ‘ä»¬è‡ªåŠ¨è§£æ DNS.
  ![è‡ªå®šä¹‰åŸŸ2](/public/images/zdyy2.png "è‡ªå®šä¹‰åŸŸ2")
5. æ·»åŠ æˆåŠŸï¼Œæ˜¾ç¤ºæ­£åœ¨éªŒè¯ã€‚
  ![è‡ªå®šä¹‰åŸŸ3](/public/images/zdyy3.png "è‡ªå®šä¹‰åŸŸ3")
6. ç­‰å¾…å‡ åˆ†é’Ÿï¼Œè®¿é—®åŸŸåå°±å¥½äº†ã€‚

[Rin]: https://github.com/openRin/Rin
[memos]: https://github.com/usememos/memos
[GitHub]: https://github.com
[Cloudflare]: https://cloudflare.com
